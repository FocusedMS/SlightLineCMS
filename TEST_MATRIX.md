# Combinatorial Test Matrix Results

This document captures a broad set of scenarios executed against the Blog CMS API and frontend to verify correct behaviour across roles, endpoints, status transitions and edge cases.  Each scenario was exercised manually and/or via automated tests where possible.  Where automated tests exist they reside under `backend/BlogCms.Tests` or `frontend/src/__tests__`.  The table below summarises the inputs, expected outcomes and observations.

| Scenario | Actors & Pre‑conditions | Action | Expected Result | Notes |
|---|---|---|---|---|
| **Auth – registration** | Guest user with unique email/username | POST `/api/Auth/register` with valid body | `200 OK` and account created; JWT not returned. Blogger role auto‑created if missing. | Duplicate emails/usernames are rejected with `400 Bad Request`. |
| **Auth – login** | Existing Blogger or Admin user; correct credentials | POST `/api/Auth/login` | Returns `200 OK` with token, user info and expiry. | Invalid credentials yield `401 Unauthorized`. |
| **Posts – list published** | Any role (including anonymous); at least one published post exists | GET `/api/Posts?page=1&pageSize=10` | Returns `200 OK` with `items`, `page`, `pageSize`, `total`.  Contains only posts with `status=Published`.  Includes strong `ETag` header. | Supplying `If‑None‑Match` equal to the ETag yields `304 Not Modified`.  Omitting pagination parameters defaults to `page=1&pageSize=10`. |
| **Posts – search** | Multiple published posts; search term matches some titles | GET `/api/Posts?search=hello` | Only posts whose title or excerpt contains “hello” are returned. | Search is case‑insensitive. |
| **Posts – get by slug** | Anonymous user; valid slug | GET `/api/Posts/{slug}` | Returns full post if published.  Includes `ETag` header. | If the post is in Draft/Pending/Rejected, returns `404 Not Found`.  Subsequent requests with matching `If‑None‑Match` receive `304 Not Modified`. |
| **Posts – get by id** | Blogger author; owns draft | GET `/api/Posts/{id}` with JWT | Returns full draft regardless of status. | Blogger cannot fetch posts owned by others (`403`).  Admin can fetch any post. |
| **Posts – create draft** | Blogger or Admin; valid JSON payload | POST `/api/Posts` | Creates a new draft with unique slug, sanitised HTML, valid category (fallback to “General”), saved tags. Returns `201 Created`. | Slug generator de‑duplicates collisions by appending a GUID suffix. |
| **Posts – update draft** | Blogger owner; existing draft | PUT `/api/Posts/{id}` with modified body | Fields are updated.  Title changes trigger slug regeneration (with de‑dupe).  Unknown tag IDs are ignored. | Attempts to change category to invalid ID are ignored. |
| **Posts – submit for review** | Blogger owner; draft or rejected post | POST `/api/Posts/{id}/submit` | Status becomes `PendingReview`. | Only drafts or rejected posts can be submitted (`400` otherwise). |
| **Posts – delete draft** | Blogger owner; draft or rejected post | DELETE `/api/Posts/{id}` | Returns `200 OK`; post removed. | Deleting a published post returns `400 Bad Request` (“Cannot delete a published post”). |
| **Moderation – list pending** | Admin | GET `/api/Moderation/posts?status=PendingReview&page=1&pageSize=10` | Returns paged list of posts with given status. | `status` query supports `Draft`, `PendingReview`, `Rejected`, `Published`.  Defaults to `PendingReview`. |
| **Moderation – approve** | Admin; post in `PendingReview` | POST `/api/Moderation/posts/{id}/approve` | Status becomes `Published`, `PublishedAt` is set to current UTC.  Returns success message. | Audit log entry created with actor ID and action “Approve”. |
| **Moderation – reject** | Admin; post in `PendingReview` | POST `/api/Moderation/posts/{id}/reject` with `{ reason: "..." }` | Status becomes `Rejected`, `PublishedAt` cleared.  Optionally stores rejection reason (min. 10 chars if supplied). | Audit log records actor and reason.  Blogger can edit and resubmit. |
| **Media – valid upload** | Authenticated blogger | POST `/api/Media/upload` with multipart form, valid image | Returns `200 OK` with JSON containing `url`, `width`, `height`, `size`.  File is stored under `/wwwroot/media/{folder}`. | Cover image field in editor auto‑populates with returned URL. |
| **Media – invalid file** | Authenticated blogger | POST `/api/Media/upload` with non‑image file | Server saves raw bytes; attempts to extract dimensions; returns `width=0,height=0` if unknown. | Non‑image types are not resized. |
| **SEO – analyzer** | Blogger; valid inputs | POST `/api/Seo/analyze` with `{ title, excerpt, contentHtml, focusKeyword }` | Returns `score` (0–100) and list of suggestions (≥5) describing improvements for title length, meta description, keyword usage, heading hierarchy, links, image alts, length and readability. | Editor displays a progress bar and suggestion list in real‑time. |
| **Frontend – route guards** | Unauthenticated user | Access `/editor` or `/dashboard` | Redirected to `/login`. | After login, user is redirected to originally intended page. |
| **Frontend – dashboard actions** | Blogger with drafts | Use UI buttons to edit, submit or delete a draft | Corresponding API calls are invoked; toasts indicate success/failure; table refreshes automatically. | Delete and reject actions show custom confirmation modals (no blocking `window.confirm`). |
| **Frontend – admin moderation** | Admin user | Use UI to approve/reject pending posts | Confirmation toast prompts; rejection prompts for optional reason; success toasts appear; list updates automatically. | Buttons are disabled while requests are in flight. |
| **Caching – 304 responses** | Any client; previously fetched posts list | Repeat GET `/api/Posts` with `If‑None‑Match` header equal to earlier `ETag` | Returns `304 Not Modified` with empty body. | Ensures minimal bandwidth usage. |
| **SEO – missing keyword** | Blogger; focus keyword omitted | Analyzer still computes score; suggestions indicate to add a keyword. | Keyword‑specific checks are skipped if none supplied. |
| **Tags – unknown IDs** | Blogger includes tag IDs that do not exist | Create/Update ignores unknown IDs; valid tag relationships persist. | Tag CRUD is outside scope. |
| **Accessibility – keyboard** | Navigate UI using Tab/Shift+Tab | Focus outlines appear on all interactive controls; modals are keyboard‑navigable. | Tested manually via keyboard traversal. |
| **Accessibility – contrast** | Inspect colours via WCAG tools | Text and backgrounds meet AA contrast ratios (>4.5:1) for primary UI elements. | Dark mode is not implemented but palette supports sufficient contrast. |

These tests represent only a subset of possible combinations but cover the critical paths and edge cases of the system.  Additional scenarios (e.g. bulk tag management, API error surfacing on the editor, concurrency handling) can be added as the product evolves.